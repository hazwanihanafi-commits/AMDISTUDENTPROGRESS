<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>AMDI Admin</title>
  <link rel="stylesheet" href="/css/style.css"/>
</head>

<body>

<div class="navbar">AMDI Admin Tools</div>

<div class="container">

  <!-- ADMIN TOOLS -->
  <div class="card">
    <h3>System Administration</h3>
    <p>Quick tools for testing, debugging, exporting logs and verifying system workflows.</p>

    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
      <button class="button" onclick="downloadApprovalLog()">Download approval log (CSV)</button>
      <button class="button" onclick="sendTestWebhook()">Send test webhook</button>
      <button class="button" onclick="triggerDailyHealth()">Run health check</button>
    </div>

    <pre id="adminOut" style="margin-top:16px;background:#f8f8f8;padding:14px;border-radius:8px;min-height:80px;"></pre>
  </div>



  <!-- ============================ -->
  <!--          MSC RUBRICS        -->
  <!-- ============================ -->
  <div class="card">
    <h3>MSc Rubrics (Research Mode)</h3>

    <a href="/mnt/data/WRITTEN REPORT AND PRESENTATION RUBRIC RESEARCH MODE (MSc).pdf"
       target="_blank"
       class="button"
       style="background:var(--usm-gold);color:black;margin-bottom:10px;display:inline-block;">
      MSc Written Report & Presentation Rubric (PDF)
    </a>

    <a href="/mnt/data/WRITTEN REPORT AND PRESENTATION RUBRIC RESEARCH MODE (MSc).pdf"
       target="_blank"
       class="button"
       style="background:#4b2e83;color:white;margin-bottom:10px;display:inline-block;">
      MSc Annual Progress (P5) Rubric
    </a>

    <p style="font-size:13px;color:#666;margin-top:10px">
      These PDFs were automatically detected from your uploaded files.
    </p>
  </div>



  <!-- ============================ -->
  <!--          PHD RUBRICS         -->
  <!-- ============================ -->
  <div class="card">
    <h3>PhD Rubrics (Research Mode)</h3>

    <a href="/mnt/data/WRITTEN REPORT AND PRESENTATION RUBRIC RESEARCH MODE (PhD).doc"
       target="_blank"
       class="button"
       style="background:#ffb81c;color:black;margin-bottom:10px;display:inline-block;">
      PhD Written Report & Presentation Rubric (DOC)
    </a>

    <p style="font-size:13px;color:#666;margin-top:10px">
      PhD rubric is a DOC file — you may upload a PDF version later for students.
    </p>
  </div>



  <!-- ============================ -->
  <!--      GENERAL P1–P5 GUIDES    -->
  <!-- ============================ -->
  <div class="card">
    <h3>General AMDI Guides (P1–P5)</h3>

    <a href="https://gamma.app/docs/PART-1-79gqtmcyqo6pqfj" target="_blank" class="button">P1–P5 Master Guide</a>
    <a href="https://gamma.app/docs/PART-1-79gqtmcyqo6pqfj#P1" target="_blank" class="button">P1 Development Plan</a>
    <a href="https://gamma.app/docs/PART-1-79gqtmcyqo6pqfj#P4" target="_blank" class="button">P4 Portfolio Guide</a>
    <a href="https://gamma.app/docs/PART-1-79gqtmcyqo6pqfj#P5" target="_blank" class="button">P5 Annual Progress</a>

    <p style="font-size:13px;color:#666;margin-top:10px">
      These links point to your Gamma P1–P5 master documentation.
    </p>
  </div>

</div>



<script>
const API_BASE = "/api";

function downloadApprovalLog(){
  window.open(`${API_BASE}/approval_log`, '_blank');
}

async function sendTestWebhook(){
  const payload = {
    submissionStage:"P5",
    studentName42:"SYSTEM TEST",
    matricNo43:"00000000"
  };
  const r = await fetch(`${API_BASE}/webhook`, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify(payload)
  });
  const j = await r.json();
  document.getElementById("adminOut").innerText = JSON.stringify(j, null, 2);
}

async function triggerDailyHealth(){
  const r = await fetch(`${API_BASE}/health`);
  const j = await r.json();
  document.getElementById("adminOut").innerText = JSON.stringify(j, null, 2);
}
</script>

</body>
</html>
